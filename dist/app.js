(()=>{var E=Object.create;var p=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var x=(s,e,n)=>e in s?p(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var C=s=>p(s,"__esModule",{value:!0});var u=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var S=(s,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of T(e))!z.call(s,t)&&(n||t!=="default")&&p(s,t,{get:()=>e[t],enumerable:!(i=F(e,t))||i.enumerable});return s},O=(s,e)=>S(C(p(s!=null?E(y(s)):{},"default",!e&&s&&s.__esModule?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var r=(s,e,n)=>(x(s,typeof e!="symbol"?e+"":e,n),n);var f=u(g=>{var B={protocol:"http",host:"127.0.0.1",port:80,hotreload:5e3,startpage:"src/index.html",errpage:"src/other/404.html",sslpath:"node_server/ssl/cert.pfx",socket:7e3};g.settings=B});var m=u((P,H)=>{H.exports=`<h3>Quart server test page (served from node):</h3>\r
<br>\r
WebSocket output:\r
<ul></ul>`});var a=class extends HTMLElement{constructor(){super();r(this,"template",e=>`<div> Custom Fragment Props: ${JSON.stringify(e)} </div>`);r(this,"props",{test:!0});r(this,"oncreate");r(this,"onresize");r(this,"ondelete");r(this,"onchanged");r(this,"fragment");r(this,"delete",()=>{this.fragment=void 0,this.remove(),this.ondelete&&this.ondelete(this.props)});r(this,"render",(e=this.props)=>{typeof this.template=="function"?this.templateString=this.template(e):this.templateString=this.template;let n=document.createElement("template");n.innerHTML=this.templateString;let i=n.content;this.fragment&&this.removeChild(this.fragment),this.fragment=i,this.appendChild(i),this.oncreate&&this.oncreate(e)});r(this,"state",{pushToState:{},data:{},triggers:{},setState(e){if(Object.assign(this.pushToState,e),Object.keys(this.triggers).length>0)for(let n of Object.getOwnPropertyNames(this.triggers))this.pushToState[n]&&(this.data[n]=this.pushToState[n],delete this.pushToState[n],this.triggers[n].forEach(i=>{i.onchanged(this.data[n])}));return this.pushToState},subscribeTrigger(e,n=i=>{}){if(e){this.triggers[e]||(this.triggers[e]=[]);let i=this.triggers[e].length;return this.triggers[e].push({idx:i,onchanged:n}),this.triggers[e].length-1}else return},unsubscribeTrigger(e,n){let i,t=this.triggers[e];if(t)if(!n)delete this.triggers[e];else return t.find(d=>{if(d.idx===n)return!0})&&t.splice(i,1),!0},subscribeTriggerOnce(e=void 0,n=i=>{}){let i,t=o=>{n(o),this.unsubscribeTrigger(e,i)};i=this.subscribeTrigger(e,t)}})}attributeChangedCallback(e,n,i){if(e==="onchanged"){let t=i;if(typeof t=="string"&&(t=h(t)),typeof t=="function"){this.onchanged=t,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged);let o=new CustomEvent("changed",{detail:{props:this.props}});this.state.subscribeTrigger("props",()=>{this.dispatchEvent(o)})}}if(e==="onresize"){let t=i;if(typeof t=="string"&&(t=h(t)),typeof t=="function"){try{window.removeEventListener("resize",this.onresize)}catch(o){}this.onresize=t,window.addEventListener("resize",this.onresize)}}if(e==="ondelete"){let t=i;typeof t=="string"&&(t=h(t)),typeof t=="function"&&(this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),t()})}if(e==="oncreate"){let t=i;typeof t=="string"&&(t=h(t)),typeof t=="function"&&(this.oncreate=t)}if(e==="props"){let t=i;typeof t=="string"&&(t=JSON.parse(t)),Object.assign(this.props,t),this.state.setState({props:this.props})}if(e==="template"){let t=i;this.template=options.template,typeof t=="function"?this.templateString=this.template(this.props):this.templateString=t,this.render(this.props);let o=new CustomEvent("created",{detail:{props:this.props}});this.dispatchEvent(o)}}connectedCallback(){let e=new CustomEvent("resized",{detail:{props:this.props}}),n=new CustomEvent("changed",{detail:{props:this.props}}),i=new CustomEvent("deleted",{detail:{props:this.props}}),t=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(t),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(n)}),typeof this.onresize=="function"&&window.addEventListener("resize",()=>{this.onresize(),this.dispatchEvent(e)}),typeof this.ondelete=="function"){let o=this.ondelete;this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),o(),this.dispatchEvent(i)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}get props(){return this.props}set props(e={}){this.setAttribute("props",e)}get template(){return this.template}set template(e){this.setAttribute("template",e)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(e){this.setAttribute("onchanged",e)}get onresize(){return this.props}set onresize(e){this.setAttribute("onresize",e)}get ondelete(){return this.props}set ondelete(e){this.setAttribute("ondelete",e)}get oncreate(){return this.oncreate}set oncreate(e){this.setAttribute("oncreated",e)}};r(a,"observedAttributes",["props","options","onchanged","onresize","ondelete","oncreate","template"]);function l(s,e,n=null){n?e?window.customElements.define(e,s,{extends:n}):window.customElements.define(s.name.toLowerCase()+"-",s,{extends:n}):e?window.customElements.define(e,s):window.customElements.define(s.name.toLowerCase()+"-",s)}function M(s=""){return s+Math.floor(Math.random()*1e15)}function h(method){let getFunctionBody=s=>s.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=s=>{let e=s.indexOf(")");return s.slice(0,s.indexOf("{",e)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let s=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(s,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let s=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(s,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var c=O(f()),L=m(),w=class extends a{constructor(){super(...arguments);r(this,"props",{host:c.settings.host,port:c.settings.socket,ws:void 0});r(this,"template",L);r(this,"oncreate",e=>{let n="localhost",i=7e3;e.ws=new WebSocket("ws://"+e.host+":"+e.port+"/"),e.ws.onmessage=t=>{let o=this.getElementsByTagName("ul")[0],d=document.createElement("li"),b=t.data,v=document.createTextNode(b);d.appendChild(v),o.appendChild(d)}});r(this,"ondelete",e=>{e.ws.close()})}};l(w,"custom-");})();
//# sourceMappingURL=app.js.map
