(()=>{var y=Object.create;var a=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var H=(s,e,n)=>e in s?a(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var B=s=>a(s,"__esModule",{value:!0});var h=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var L=(s,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of z(e))!O.call(s,t)&&(n||t!=="default")&&a(s,t,{get:()=>e[t],enumerable:!(i=C(e,t))||i.enumerable});return s},m=(s,e)=>L(B(a(s!=null?y(S(s)):{},"default",!e&&s&&s.__esModule?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s);var r=(s,e,n)=>(H(s,typeof e!="symbol"?e+"":e,n),n);var u=h(w=>{var M={protocol:"http",host:"localhost",port:8e3,hotreload:5e3,startpage:"src/index.html",errpage:"src/other/404.html",sslpath:"node_server/ssl/cert.pfx",quart:7e3};w.settings=M});var b=h((k,$)=>{$.exports='<div style="display:none">SSE Test Component (check console)</div>'});var v=h((R,N)=>{N.exports=`<h3>Quart server test page (built from node):</h3>\r
<br>\r
WebSocket output:\r
<ul></ul>`});var T=h((X,q)=>{q.exports="<div>Hello World!</div>"});var d=class extends HTMLElement{constructor(){super();r(this,"template",e=>`<div> Custom Fragment Props: ${JSON.stringify(e)} </div>`);r(this,"props",{test:!0});r(this,"oncreate");r(this,"onresize");r(this,"ondelete");r(this,"onchanged");r(this,"fragment");r(this,"delete",()=>{this.fragment=void 0,this.remove(),this.ondelete&&this.ondelete(this.props)});r(this,"render",(e=this.props)=>{typeof this.template=="function"?this.templateString=this.template(e):this.templateString=this.template;let n=document.createElement("template");n.innerHTML=this.templateString;let i=n.content;this.fragment&&this.removeChild(this.fragment),this.fragment=i,this.appendChild(i),this.oncreate&&this.oncreate(e)});r(this,"state",{pushToState:{},data:{},triggers:{},setState(e){if(Object.assign(this.pushToState,e),Object.keys(this.triggers).length>0)for(let n of Object.getOwnPropertyNames(this.triggers))this.pushToState[n]&&(this.data[n]=this.pushToState[n],delete this.pushToState[n],this.triggers[n].forEach(i=>{i.onchanged(this.data[n])}));return this.pushToState},subscribeTrigger(e,n=i=>{}){if(e){this.triggers[e]||(this.triggers[e]=[]);let i=this.triggers[e].length;return this.triggers[e].push({idx:i,onchanged:n}),this.triggers[e].length-1}else return},unsubscribeTrigger(e,n){let i,t=this.triggers[e];if(t)if(!n)delete this.triggers[e];else return t.find(l=>{if(l.idx===n)return!0})&&t.splice(i,1),!0},subscribeTriggerOnce(e=void 0,n=i=>{}){let i,t=o=>{n(o),this.unsubscribeTrigger(e,i)};i=this.subscribeTrigger(e,t)}})}attributeChangedCallback(e,n,i){if(e==="onchanged"){let t=i;if(typeof t=="string"&&(t=c(t)),typeof t=="function"){this.onchanged=t,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged);let o=new CustomEvent("changed",{detail:{props:this.props}});this.state.subscribeTrigger("props",()=>{this.dispatchEvent(o)})}}if(e==="onresize"){let t=i;if(typeof t=="string"&&(t=c(t)),typeof t=="function"){try{window.removeEventListener("resize",this.onresize)}catch(o){}this.onresize=t,window.addEventListener("resize",this.onresize)}}if(e==="ondelete"){let t=i;typeof t=="string"&&(t=c(t)),typeof t=="function"&&(this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),t()})}if(e==="oncreate"){let t=i;typeof t=="string"&&(t=c(t)),typeof t=="function"&&(this.oncreate=t)}if(e==="props"){let t=i;typeof t=="string"&&(t=JSON.parse(t)),Object.assign(this.props,t),this.state.setState({props:this.props})}if(e==="template"){let t=i;this.template=options.template,typeof t=="function"?this.templateString=this.template(this.props):this.templateString=t,this.render(this.props);let o=new CustomEvent("created",{detail:{props:this.props}});this.dispatchEvent(o)}}connectedCallback(){let e=new CustomEvent("resized",{detail:{props:this.props}}),n=new CustomEvent("changed",{detail:{props:this.props}}),i=new CustomEvent("deleted",{detail:{props:this.props}}),t=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(t),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(n)}),typeof this.onresize=="function"&&window.addEventListener("resize",()=>{this.onresize(),this.dispatchEvent(e)}),typeof this.ondelete=="function"){let o=this.ondelete;this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),o(),this.dispatchEvent(i)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}get props(){return this.props}set props(e={}){this.setAttribute("props",e)}get template(){return this.template}set template(e){this.setAttribute("template",e)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(e){this.setAttribute("onchanged",e)}get onresize(){return this.props}set onresize(e){this.setAttribute("onresize",e)}get ondelete(){return this.props}set ondelete(e){this.setAttribute("ondelete",e)}get oncreate(){return this.oncreate}set oncreate(e){this.setAttribute("oncreated",e)}};r(d,"observedAttributes",["props","options","onchanged","onresize","ondelete","oncreate","template"]);function p(s,e,n=null){n?e?window.customElements.define(e,s,{extends:n}):window.customElements.define(s.name.toLowerCase()+"-",s,{extends:n}):e?window.customElements.define(e,s):window.customElements.define(s.name.toLowerCase()+"-",s)}function P(s=""){return s+Math.floor(Math.random()*1e15)}function c(method){let getFunctionBody=s=>s.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=s=>{let e=s.indexOf(")");return s.slice(0,s.indexOf("{",e)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let s=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(s,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let s=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(s,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var g=m(u()),A=b(),E=class extends d{constructor(){super(...arguments);r(this,"props",{host:g.settings.host,port:g.settings.quart,es:void 0});r(this,"template",A);r(this,"oncreate",e=>{e.es=new EventSource(`http://${e.host}:${e.port}/sse`),e.es.onmessage=function(n){console.log("Event Source:",n.data)}});r(this,"ondelete",e=>{e.es.close()})}};p(E,"sse-test");var f=m(u()),j=v(),F=class extends d{constructor(){super(...arguments);r(this,"props",{host:f.settings.host,port:f.settings.quart,ws:void 0});r(this,"template",j);r(this,"oncreate",e=>{e.ws=new WebSocket(`ws://${e.host}:${e.port}/`),e.ws.onmessage=n=>{let i=this.getElementsByTagName("ul")[0],t=document.createElement("li"),o=n.data,l=document.createTextNode(o);t.appendChild(l),i.appendChild(t)}});r(this,"ondelete",e=>{e.ws.close()})}};p(F,"socket-test");var D=T(),x=class extends d{constructor(){super(...arguments);r(this,"props",{});r(this,"template",D);r(this,"oncreate",e=>{console.log("Custom html component created!")});r(this,"ondelete",e=>{console.log("Custom html component deleted!")})}};p(x,"custom-");})();
//# sourceMappingURL=app.js.map
